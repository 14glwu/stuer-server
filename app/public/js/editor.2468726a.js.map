{"version":3,"sources":["webpack:///./src/pages/index/views/editor/index.vue?8f37","webpack:///src/pages/index/views/editor/index.vue","webpack:///./src/pages/index/views/editor/index.vue?c86f","webpack:///./src/pages/index/views/editor/index.vue","webpack:///./src/pages/index/views/editor/index.vue?c71f"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","header_name","attrs","href","header_draft","size","type","on","click","setPost","directives","name","rawName","value","form","expression","placeholder","domProps","input","$event","target","composing","$set","titleChange","ref","title","visible","dialogVisible","top","update:visible","model","label","label-width","formLabelWidth","callback","$$v","_n","_l","tag","key","closable","disable-transitions","close","handleClose","blur","handleInputConfirm","nativeOn","keyup","indexOf","_k","keyCode","inputValue","showInput","_e","slot","submitPost","staticRenderFns","editorvue_type_script_lang_js_","data","editor","isEdit","content","tags","titleTimer","contentTimer","inputVisible","computed","Object","objectSpread","vuex_esm","mounted","_mounted","asyncToGenerator","regeneratorRuntime","mark","_callee","wrap","_context","prev","next","initEditor","initContent","stop","apply","arguments","beforeDestroy","clearTimeout","self","methods","_submitPost","_callee2","text","result","_result","_context2","txt","$message","error","abrupt","html","api","sent","code","success","localStorage","removeItem","splice","_this","$nextTick","_","$refs","saveTagInput","focus","push","setTimeout","setItem","E","window","wangEditor","editor_bar","editor_main","customConfig","zIndex","uploadImgServer","uploadImgMaxSize","uploadImgMaxLength","onchangeTimeout","customAlert","info","onchange","create","_initContent","_callee3","draft","draftTitle","post","_context3","getItem","$route","query","id","userId","user","views_editorvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_43fc3175_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_index_vue_vue_type_style_index_0_id_43fc3175_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/editor.2468726a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"editor-container block\"},[_c('div',{staticClass:\"editor-header\"},[_c('div',{staticClass:\"header-left\"},[_c('div',{staticClass:\"header-name\"},[_vm._v(_vm._s(_vm.header_name))]),_c('a',{staticClass:\"header-daft\",attrs:{\"href\":\"javascript:void(0)\"}},[_vm._v(_vm._s(_vm.header_draft))])]),_c('div',[_c('el-button',{attrs:{\"size\":\"small\"}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.setPost}},[_vm._v(\"确定\")])],1)]),_c('div',{staticClass:\"editor-post-title\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.form.title),expression:\"form.title\"}],staticClass:\"title-input\",attrs:{\"type\":\"text\",\"placeholder\":\"帖子标题：一句话说明你遇到的问题或想分享的经验\"},domProps:{\"value\":(_vm.form.title)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.$set(_vm.form, \"title\", $event.target.value)},_vm.titleChange]}})]),_c('div',{staticClass:\"editor\"},[_c('div',{ref:\"editor_bar\",staticClass:\"editor-bar\"}),_c('div',{ref:\"editor_main\",staticClass:\"editor-main\"})]),_c('el-dialog',{staticClass:\"dialog\",attrs:{\"title\":\"帖子设置\",\"visible\":_vm.dialogVisible,\"top\":\"25vh\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{attrs:{\"model\":_vm.form}},[_c('el-form-item',{attrs:{\"label\":\"发表区域\",\"label-width\":_vm.formLabelWidth}},[_c('el-select',{attrs:{\"placeholder\":\"请选择发表区域\"},model:{value:(_vm.form.type),callback:function ($$v) {_vm.$set(_vm.form, \"type\", _vm._n($$v))},expression:\"form.type\"}},[_c('el-option',{attrs:{\"label\":\"讨论区\",\"value\":1}}),_c('el-option',{attrs:{\"label\":\"树洞\",\"value\":2}}),_c('el-option',{attrs:{\"label\":\"找对象\",\"value\":3}}),_c('el-option',{attrs:{\"label\":\"求职区\",\"value\":4}})],1)],1),(_vm.form.type === 1)?_c('el-form-item',{attrs:{\"label\":\"帖子标签\",\"label-width\":_vm.formLabelWidth}},[_vm._l((_vm.form.tags),function(tag){return _c('el-tag',{key:tag,attrs:{\"closable\":\"\",\"disable-transitions\":false},on:{\"close\":function($event){return _vm.handleClose(tag)}}},[_vm._v(_vm._s(tag))])}),(_vm.inputVisible)?_c('el-input',{ref:\"saveTagInput\",staticClass:\"input-new-tag\",attrs:{\"size\":\"small\"},on:{\"blur\":_vm.handleInputConfirm},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.handleInputConfirm($event)}},model:{value:(_vm.inputValue),callback:function ($$v) {_vm.inputValue=$$v},expression:\"inputValue\"}}):_c('el-button',{staticClass:\"button-new-tag\",attrs:{\"size\":\"small\"},on:{\"click\":_vm.showInput}},[_vm._v(\"+ 新标签\")])],2):_vm._e()],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submitPost}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"editor-container block\">\n    <div class=\"editor-header\">\n      <div class=\"header-left\">\n        <div class=\"header-name\">{{header_name}}</div>\n        <a href=\"javascript:void(0)\" class=\"header-daft\">{{header_draft}}</a>\n      </div>\n      <div>\n        <el-button size=\"small\">取消</el-button>\n        <el-button size=\"small\" type=\"primary\" @click=\"setPost\">确定</el-button>\n      </div>\n    </div>\n    <div class=\"editor-post-title\">\n      <input\n        type=\"text\"\n        class=\"title-input\"\n        placeholder=\"帖子标题：一句话说明你遇到的问题或想分享的经验\"\n        v-model=\"form.title\"\n        @input=\"titleChange\"\n      >\n    </div>\n    <div class=\"editor\">\n      <div ref=\"editor_bar\" class=\"editor-bar\"></div>\n      <div ref=\"editor_main\" class=\"editor-main\"></div>\n    </div>\n\n    <el-dialog title=\"帖子设置\" class=\"dialog\" :visible.sync=\"dialogVisible\" top=\"25vh\">\n      <el-form :model=\"form\">\n        <el-form-item label=\"发表区域\" :label-width=\"formLabelWidth\">\n          <el-select v-model.number=\"form.type\" placeholder=\"请选择发表区域\">\n            <el-option label=\"讨论区\" :value=\"1\"></el-option>\n            <el-option label=\"树洞\" :value=\"2\"></el-option>\n            <el-option label=\"找对象\" :value=\"3\"></el-option>\n            <el-option label=\"求职区\" :value=\"4\"></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"帖子标签\" :label-width=\"formLabelWidth\" v-if=\"form.type === 1\">\n          <el-tag\n            :key=\"tag\"\n            v-for=\"tag in form.tags\"\n            closable\n            :disable-transitions=\"false\"\n            @close=\"handleClose(tag)\"\n          >{{tag}}</el-tag>\n          <el-input\n            class=\"input-new-tag\"\n            v-if=\"inputVisible\"\n            v-model=\"inputValue\"\n            ref=\"saveTagInput\"\n            size=\"small\"\n            @keyup.enter.native=\"handleInputConfirm\"\n            @blur=\"handleInputConfirm\"\n          ></el-input>\n          <el-button v-else class=\"button-new-tag\" size=\"small\" @click=\"showInput\">+ 新标签</el-button>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitPost\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\nimport { createPost, updatePost, getPostById } from '@/api';\nexport default {\n  data() {\n    return {\n      header_name: '写帖子',\n      header_draft: '',\n      editor: null, // 富文本编辑器\n      isEdit: false, // 用于判断是编辑帖子还是发表帖子\n      form: {\n        title: '', // 帖子标题\n        content: '', // 帖子内容\n        type: 1, // 帖子发表区域，默认为1讨论区\n        tags: [\n          // 帖子标签\n        ]\n      },\n      titleTimer: null,\n      contentTimer: null,\n      dialogVisible: false,\n      formLabelWidth: '120px',\n      inputVisible: false,\n      inputValue: ''\n    };\n  },\n  computed: {\n    ...mapGetters(['user'])\n  },\n  async mounted() {\n    this.initEditor(); // 初始化编辑器\n    await this.initContent(); // 初始化帖子内容\n  },\n  beforeDestroy() {\n    // 清空页面的定时器\n    if (this.contentTimer) {\n      clearTimeout(this.contentTimer);\n      self.contentTimer = null;\n    }\n    if (this.titleTimer) {\n      clearTimeout(this.titleTimer);\n      self.titleTimer = null;\n    }\n  },\n  methods: {\n    // 提交帖子\n    async submitPost() {\n      this.dialogVisible = false;\n\n      // 参数校验\n      const text = this.editor.txt.text();\n      if (!text) {\n        this.$message.error('内容不能为空');\n        return;\n      }\n      if (this.form.type !== 2 && !this.form.title) {\n        this.$message.error('标题不能为空');\n        return;\n      }\n\n      this.form.content = this.editor.txt.html(); // 将富文本内容赋值给表单的content\n      if (!this.isEdit) {\n        const result = await createPost(this.form);\n        if (result.code === 0) {\n          this.$message.success('帖子发表成功');\n          localStorage.removeItem('draft');\n          localStorage.removeItem('draftTitle');\n          this.header_draft = '';\n        } else {\n          this.$message.error('帖子发表失败');\n        }\n      } else {\n        const result = await updatePost(this.form);\n        if (result.code === 0) {\n          this.$message.success('帖子更新成功');\n        } else {\n          this.$message.error('帖子更新失败');\n        }\n      }\n    },\n    // 设置帖子\n    setPost() {\n      this.dialogVisible = true;\n    },\n    // 删除标签\n    handleClose(tag) {\n      this.form.tags.splice(this.form.tags.indexOf(tag), 1);\n    },\n    // 显示输入标签框\n    showInput() {\n      this.inputVisible = true;\n      this.$nextTick((_) => {\n        this.$refs.saveTagInput.$refs.input.focus();\n      });\n    },\n    // 输入标签\n    handleInputConfirm() {\n      const inputValue = this.inputValue;\n      if (inputValue) {\n        this.form.tags.push(inputValue);\n      }\n      this.inputVisible = false;\n      this.inputValue = '';\n    },\n    // 监听标题的变化\n    titleChange() {\n      const self = this; // this在回调函数中会被改变，因此用self\n      self.header_draft = '草稿保存中...';\n      if (self.titleTimer) {\n        // 防抖处理\n        clearTimeout(self.titleTimer);\n        self.titleTimer = null;\n      }\n      const title = self.form.title;\n      // 监听输入变化,然后保存到storage中，从而实现草稿功能\n      self.titleTimer = setTimeout(function() {\n        localStorage.setItem('draftTitle', title);\n        self.header_draft = '草稿已保存';\n      }, 1500);\n    },\n    // 初始化编辑器\n    initEditor() {\n      const E = window.wangEditor;\n      this.editor = new E(this.$refs.editor_bar, this.$refs.editor_main);\n      this.editor.customConfig.zIndex = 100; // 层级\n      this.editor.customConfig.uploadImgServer = '/api/uploadImgsForPost'; // 上传图片到服务器的地址\n      this.editor.customConfig.uploadImgMaxSize = 3 * 1024 * 1024; // 上传图片的最大大小\n      this.editor.customConfig.uploadImgMaxLength = 5; // 上传图片的最大个数\n      this.editor.customConfig.onchangeTimeout = 1000; // onchange 触发的延迟时间, 单位 ms\n      const self = this; // this在回调函数中会被改变，因此用self\n      // 错误监听\n      this.editor.customConfig.customAlert = function(info) {\n        // info 是需要提示的内容\n        self.$message.error(info);\n      };\n\n      // 监听帖子内容的变化\n      this.editor.customConfig.onchange = (html) => {\n        if (self.contentTimer) {\n          // 防抖处理\n          clearTimeout(self.contentTimer);\n          self.contentTimer = null;\n        }\n        // 监听输入变化,然后保存到storage中，从而实现草稿功能\n        self.header_draft = '草稿保存中...';\n        localStorage.setItem('draft', html);\n        self.contentTimer = setTimeout(function() {\n          self.header_draft = '草稿已保存';\n        }, 2000);\n      };\n      this.editor.create();\n    },\n    // 初始化帖子内容\n    async initContent() {\n      // 如果草稿箱不为空的话\n      const draft = localStorage.getItem('draft');\n      const draftTitle = localStorage.getItem('draftTitle');\n      if (draft) {\n        this.editor.txt.html(draft);\n      }\n      if (draftTitle) {\n        this.form.title = draftTitle;\n      }\n      // 如果设置完草稿后，文本内容为空的话，则设置默认提示文字\n      const text = this.editor.txt.text();\n      if (!text) {\n        this.editor.txt.html('<p>来写点东西，抒发你心中所想吧！！！</p>');\n      }\n      // 如果是编辑帖子\n      if (this.$route.query.id) {\n        this.isEdit = true;\n        const result = await getPostById(this.$route.query.id);\n        if (result.code === 0) {\n          const post = result.data;\n          // 判断是否为帖子主人,不是则跳转至首页，当然如果帖子类型为树洞，也跳转至首页\n          if (post.userId !== this.user.id || post.type === 2) {\n            this.$route.push('/');\n          } else {\n            this.form = post;\n            if (post.content) {\n              // 如果帖子不为空的话\n              this.editor.txt.html(post.content);\n            }\n          }\n        }\n      }\n    }\n  }\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import '~@/style/variables.scss';\n.editor-container {\n  position: relative;\n  width: 100%;\n  height: 806px;\n  background: #fff;\n  margin: 1rem auto;\n}\n.editor-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  padding: 0 2rem;\n  height: 5rem;\n  border-bottom: 1px solid #f1f1f1;\n}\n.header {\n  &-left {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n  }\n  &-daft {\n    font-size: 1.2rem;\n    color: $link-color;\n  }\n  &-name {\n    margin-right: 1rem;\n    font-size: 2rem;\n    color: $primary-color;\n    font-weight: bold;\n    &:before {\n      content: '>> ';\n    }\n  }\n}\n.editor-post-title {\n  width: 100%;\n  padding: 0 2rem;\n  .title-input {\n    display: inline-block;\n    width: 100%;\n    vertical-align: middle;\n    text-align: left;\n    font: 200 1.8rem 'microsoft yahei';\n    height: 5rem;\n    padding: 0 1rem;\n    overflow: hidden;\n    border: none;\n    outline: none;\n    white-space: nowrap;\n  }\n}\n.editor {\n  width: 100%;\n  height: calc(100% - 10rem);\n  padding: 0 2rem;\n  font-size: 1.25rem;\n  .editor-bar {\n    border: 1px solid #ddd;\n  }\n  .editor-main {\n    height: calc(100% - 4rem);\n    border: 1px solid #ddd;\n  }\n}\n.el-tag + .el-tag {\n  margin-left: 1rem;\n}\n.button-new-tag {\n  margin-left: 1rem;\n  height: 3rem;\n  line-height: 3rem;\n  padding-top: 0;\n  padding-bottom: 0;\n}\n.input-new-tag {\n  width: 8rem;\n  margin-left: 1rem;\n  vertical-align: bottom;\n}\n</style>\n","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=43fc3175&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=43fc3175&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"43fc3175\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=43fc3175&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=43fc3175&scoped=true&lang=scss&\""],"sourceRoot":""}